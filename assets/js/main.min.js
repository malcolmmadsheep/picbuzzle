"use strict";$(function(){function y(){var c=j.prop("src");a.startGame(b,c),x.prop("src",c)}function z(a){b=parseInt(a.target.value)}function A(){q.prop("disabled",!0).addClass("disabled")}function B(){q.prop("disabled",!1).removeClass("disabled")}function C(a){$(a).addClass("selected-item")}function D(a){e||(e=!0,i.animate({left:a},300,function(){e=!1}))}function E(a){h.val(""),k.css("display","block"),$(this).css("display","none")}function F(){for(var a=0;a<n.length;a++){var b=n[a];if($(b).hasClass("selected-item"))return a}}function G(){for(var a=0;a<n.length;a++){var b=$(n[a]);b.hasClass("selected-item")&&b.removeClass("selected-item")}}function H(){a.SECTIONS=$("section");for(var b=0;b<a.SECTIONS.length;b++)a.SECTIONS[b].isActive=!0;a.setActiveSection("menu")}function I(a){var b=$(a.target);b.hasClass("borderedpi")||b.addClass("borderedpi"),$(this).css("display","block"),k.css("display","none"),B()}function J(a){var b=a.target.files[0],c=new FileReader;G(),c.addEventListener("loadend",function(a){j.attr("src",c.result)}),b&&(A(),c.readAsDataURL(b))}function K(a){var b=h.val().trim();return""===b?void h.val(""):(A(),$.ajax("loadimage.php",{method:"GET",data:{url:b},success:function(a){0!==a.indexOf("[")&&(a=a.substr(a.indexOf("[")));var b=JSON.parse(a);j.attr("src",b[0].data)}}),void G())}function L(){for(var a=i.children().toArray(),b=$(a[0]),c=b.outerWidth()+parseInt(b.css("marginRight")),e=1;0===c;)c=$(a[e]).outerWidth()+parseInt($(a[e]).css("marginRight"))/a.length,e++;a.length>5&&(a.forEach(function(a){var b=$(a).outerWidth();0===b&&(b=c),d+=b+parseInt($(a).css("marginRight"))}),i.width(d))}function M(a){var b=a.originalEvent.deltaY,f=(a.target,a.type,parseInt(i.css("left"))),g=150,h=m.width();0>b&&0>f?(f+=g,f>=0&&(f=0)):b>0&&d-Math.abs(f)>h&&(f-=g,Math.abs(f)>h&&(f=h-d)),D(f)}function N(a){var b=a.type,e=a.originalEvent.changedTouches[0];if("touchstart"===b)c=e.screenX;else if("touchend"===b){var f=e.screenX-c,g=parseInt(i.css("left")),h=m.width();g+=f,g>0?g=0:d-h<Math.abs(g)&&(g=h-d),i.animate({left:g},350)}}function O(a){var b=a.target,c=F(),e=0,f=c;n.length;G(),C(b),f=F(),f>1?e=n.get(f-2).offsetLeft:1===f&&(e=n.get(0).offsetLeft),d-m.width()<e&&(e=d-m.width()),i.animate({left:-e},250),j.prop("src",$(b).prop("src"))}function P(a){var f,b=F(),c=$(a.target),e=b;c.is("div")||(c=$(c.parents("div").get(0))),G();var g=c.prop("id");"nextPictureButton"===g?b<n.length-1&&(e=b+1,e>1?f=$(n[e-2]).get(0).offsetLeft:1===e&&(f=$(n[0]).get(0).offsetLeft)):b>0&&(e=b-1,e>1?f=$(n[e-2]).get(0).offsetLeft:1===e&&(f=$(n[0]).get(0).offsetLeft));var h=$(n[e]).get(0);C(h),j.prop("src",h.src),f>d-m.width()&&(f=d-m.width()),i.animate({left:-f},250)}function Q(a){var b=parseInt(w.css("top")),c=b+w.outerHeight();0===b?(c=b,b=-w.outerHeight()):(b=0,c=w.outerHeight()),w.animate({top:b}),$(this).animate({top:c}),w.isDown=!w.isDown}function R(a){w.isDown&&v.click()}function S(){L(),H(),$(n[0]).click()}function T(){l.on("change",z),f.on("change",J),j.on("error",E),j.on("load",I),s.on("mousedown",P),u.on("mousedown",P),q.on("click",y),p.on("click",a.shuffle.bind(a)),t.on("click",K),o.on("click",a.tryAgainButtonClick.bind(a)),r.on("click",R),r.on("click",a.goToResultsButtonClick.bind(a)),n.on("click",O),i.on("wheel",M),i.on("touchstart",N),i.on("touchend",N),v.on("click",Q),window.addEventListener("keydown",a.handleKeyInput.bind(a),!1)}var a=new Picpuzzle,b=3,c=0,d=0,e=!1,f=$("#fromfile"),h=($("section"),$("#imageUrl")),i=$("#items"),j=$("#previewPicture"),k=$("#imageLoadingFail"),l=$('input[name="complexity"'),m=$("#collectionItemsList"),n=$(".collection-item").children("img"),o=$("#tryAgainButton"),p=$("#reshuffleButton"),q=$("#startGameButton"),r=$("#rageQuitButton"),s=$("#nextPictureButton"),t=$("#getImageByURLButton"),u=$("#previousPictureButton"),v=$("#helplabel"),w=$("#helpbox"),x=$("#helpPicture");T(),S()});